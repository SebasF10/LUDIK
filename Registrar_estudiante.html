<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Estudiante</title>
    <link rel="stylesheet" href="Css/registrar_estudiante.css">
</head>

<body>
    <header>
        <div class="header-container">
            <div class="header-left">
                <img src="img/Ludik2.png" alt="Logo Institución" class="logo-institucion">
                <h1 class="titulo-ludik">Registro de Estudiante</h1>
            </div>
            <div class="header-right">
                <button type="button" class="btn-nav btn-inicio" id="btn-inicio">Ir a Inicio</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <section class="section">
            <h1>Formulario de Registro</h1>
            
            <!-- Indicador de progreso -->
            <div class="progress-indicator">
                <div class="step-indicator active" id="indicator-1">1</div>
                <div class="step-indicator" id="indicator-2">2</div>
                <div class="step-indicator" id="indicator-3">3</div>
                <div class="step-indicator" id="indicator-4">4</div>
                <div class="step-indicator" id="indicator-5">5</div>
            </div>
            
            <form id="registro-multi-paso" action="php/registrar_estudiante.php" method="POST">
                <!-- Paso 1: Madre -->
                <div class="form-step" id="paso-madre">
                    <h2>Datos de la Madre</h2>
                    <label for="madre_nombre">Nombre completo:</label>
                    <input type="text" id="madre_nombre" name="madre_nombre" required>
                    <label for="madre_nivel">Nivel educativo:</label>
                    <input type="text" id="madre_nivel" name="madre_nivel" required>
                    <label for="madre_ocupacion">Ocupación:</label>
                    <input type="text" id="madre_ocupacion" name="madre_ocupacion" required>
                    <label for="madre_email">Email:</label>
                    <input type="email" id="madre_email" name="madre_email" required>
                    <label for="madre_contrasena">Contraseña:</label>
                    <input type="password" id="madre_contrasena" name="madre_contrasena" required>
                    <label for="madre_telefono">Teléfono:</label>
                    <input type="tel" id="madre_telefono" name="madre_telefono" required>
                    
                    <div class="navigation-buttons">
                        <div></div> <!-- Espacio vacío para alineación -->
                        <button type="button" class="btn-nav btn-siguiente" id="btn-siguiente-madre">Siguiente</button>
                    </div>
                </div>
                
                <!-- Paso 2: Padre -->
                <div class="form-step" id="paso-padre" style="display:none;">
                    <h2>Datos del Padre</h2>
                    <label for="padre_nombre">Nombre completo:</label>
                    <input type="text" id="padre_nombre" name="padre_nombre" required>
                    <label for="padre_nivel">Nivel educativo:</label>
                    <input type="text" id="padre_nivel" name="padre_nivel" required>
                    <label for="padre_ocupacion">Ocupación:</label>
                    <input type="text" id="padre_ocupacion" name="padre_ocupacion" required>
                    <label for="padre_email">Email:</label>
                    <input type="email" id="padre_email" name="padre_email" required>
                    <label for="padre_contrasena">Contraseña:</label>
                    <input type="password" id="padre_contrasena" name="padre_contrasena" required>
                    <label for="padre_telefono">Teléfono:</label>
                    <input type="tel" id="padre_telefono" name="padre_telefono" required>
                    
                    <div class="navigation-buttons">
                        <button type="button" class="btn-nav btn-anterior" id="btn-anterior-padre">Anterior</button>
                        <button type="button" class="btn-nav btn-siguiente" id="btn-siguiente-padre">Siguiente</button>
                    </div>
                </div>
                
                <!-- Paso 3: Cuidador -->
                <div class="form-step" id="paso-cuidador" style="display:none;">
                    <h2>Datos del Acudiente/Cuidador</h2>
                    <label for="cuidador_nombre">Nombre completo:</label>
                    <input type="text" id="cuidador_nombre" name="cuidador_nombre" required>
                    <label for="cuidador_parentesco">Parentesco:</label>
                    <input type="text" id="cuidador_parentesco" name="cuidador_parentesco" required>
                    <label for="cuidador_nivel">Nivel educativo:</label>
                    <input type="text" id="cuidador_nivel" name="cuidador_nivel" required>
                    <label for="cuidador_ocupacion">Ocupación:</label>
                    <input type="text" id="cuidador_ocupacion" name="cuidador_ocupacion" required>
                    <label for="cuidador_email">Email:</label>
                    <input type="email" id="cuidador_email" name="cuidador_email" required>
                    <label for="cuidador_contrasena">Contraseña:</label>
                    <input type="password" id="cuidador_contrasena" name="cuidador_contrasena" required>
                    <label for="cuidador_telefono">Teléfono:</label>
                    <input type="tel" id="cuidador_telefono" name="cuidador_telefono" required>
                    
                    <div class="navigation-buttons">
                        <button type="button" class="btn-nav btn-anterior" id="btn-anterior-cuidador">Anterior</button>
                        <button type="button" class="btn-nav btn-siguiente" id="btn-siguiente-cuidador">Siguiente</button>
                    </div>
                </div>
                
                <!-- Paso 4: Estudiante -->
                <div class="form-step" id="paso-estudiante" style="display:none;">
                    <h2>Datos del Estudiante</h2>
                    <label for="estudiante_nombre">Nombre:</label>
                    <input type="text" id="estudiante_nombre" name="estudiante_nombre" required>
                    <label for="estudiante_apellidos">Apellidos:</label>
                    <input type="text" id="estudiante_apellidos" name="estudiante_apellidos" required>
                    <label for="tipo_documento">Tipo de documento:</label>
                    <select id="tipo_documento" name="tipo_documento" required>
                        <option value="">Seleccione...</option>
                        <option value="TI">Tarjeta de Identidad</option>
                        <option value="CC">Cédula</option>
                        <option value="RC">Registro Civil</option>
                        <option value="CE">Cédula de Extranjería</option>
                    </select>
                    <label for="no_documento">Número de documento:</label>
                    <input type="text" id="no_documento" name="no_documento" required>
                    <label for="lugar_nacimiento">Lugar de nacimiento:</label>
                    <input type="text" id="lugar_nacimiento" name="lugar_nacimiento" required>
                    <label for="fecha_nacimiento">Fecha de nacimiento:</label>
                    <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" required>
                    <label for="sector">Sector:</label>
                    <select id="sector" name="sector" required>
                        <option value="">Seleccione...</option>
                        <option value="Urbano">Urbano</option>
                        <option value="Rural">Rural</option>
                    </select>
                    <label for="direccion">Dirección:</label>
                    <input type="text" id="direccion" name="direccion" required>
                    <label for="telefono">Teléfono:</label>
                    <input type="tel" id="telefono" name="telefono" required>
                    <label for="correo">Email:</label>
                    <input type="email" id="correo" name="correo" required>
                    <label for="contrasena">Contraseña:</label>
                    <input type="password" id="contrasena" name="contrasena" required>
                    <label for="victima_conflicto">¿Se reconoce como víctima del conflicto armado?</label>
                    <select id="victima_conflicto" name="victima_conflicto" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    <div id="victima_tipo_container" style="display:none;">
                        <label for="victima_tipo">¿Cuál?</label>
                        <input type="text" id="victima_tipo" name="victima_tipo">
                    </div>
                    <label for="registro_victima">¿Cuenta con el correspondiente registro de víctima?</label>
                    <select id="registro_victima" name="registro_victima" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    <label for="centro_proteccion">¿Está en algún centro de protección?</label>
                    <select id="centro_proteccion" name="centro_proteccion" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    <label for="grupo_etnico">¿Se reconoce o pertenece a algún grupo étnico?</label>
                    <select id="grupo_etnico" name="grupo_etnico" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    <div id="etnico_tipo_container" style="display:none;">
                        <label for="etnico_tipo">¿Cuál?</label>
                        <input type="text" id="etnico_tipo" name="etnico_tipo">
                    </div>
                    <label for="no_hermanos">Número de hermanos:</label>
                    <input type="number" id="no_hermanos" name="no_hermanos" min="0" required>
                    <label for="lugar_que_ocupa">Lugar que ocupa:</label>
                    <input type="text" id="lugar_que_ocupa" name="lugar_que_ocupa" required>
                    <label for="con_quien_vive">¿Con quién vive el estudiante?</label>
                    <input type="text" id="con_quien_vive" name="con_quien_vive" required>
                    <label for="quien_apoya_crianza">¿Quién apoya la crianza?</label>
                    <input type="text" id="quien_apoya_crianza" name="quien_apoya_crianza" required>
                    <label for="afiliacion_salud">¿Afiliación al sistema de salud?</label>
                    <select id="afiliacion_salud" name="afiliacion_salud" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    
                    <div class="navigation-buttons">
                        <button type="button" class="btn-nav btn-anterior" id="btn-anterior-estudiante">Anterior</button>
                        <button type="button" class="btn-nav btn-siguiente" id="btn-siguiente-estudiante">Siguiente</button>
                    </div>
                </div>
                
                <!-- Paso 5: Entorno Educativo -->
                <div class="form-step" id="paso-entorno-educativo" style="display:none;">
                    <h2>Entorno Educativo</h2>
                    
                    <label for="estado">Estado:</label>
                    <select id="estado" name="estado" required>
                        <option value="">Seleccione...</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Sin aprobar">Sin aprobar</option>
                    </select>
                    
                    <label for="ultimo_grado_cursado">Último grado cursado:</label>
                    <input type="text" id="ultimo_grado_cursado" name="ultimo_grado_cursado" required>
                    
                    <label for="vinculado_otra_inst">¿Ha estado vinculado en otra institución educativa, fundación o bajo otra modalidad de educación?</label>
                    <select id="vinculado_otra_inst" name="vinculado_otra_inst" required>
                        <option value="">Seleccione...</option>
                        <option value="No">No</option>
                        <option value="Si">Sí</option>
                    </select>
                    
                    <div id="vinculado_detalles_container" style="display:none;">
                        <label for="vinculado_detalles">¿Cuáles? (Detalle las instituciones o modalidades):</label>
                        <textarea id="vinculado_detalles" name="vinculado_detalles" rows="3" placeholder="Describa las instituciones o modalidades..."></textarea>
                    </div>
                    
                    <div id="no_vinculado_razon_container" style="display:none;">
                        <label for="no_vinculado_razon">¿Por qué no ha estado vinculado?</label>
                        <textarea id="no_vinculado_razon" name="no_vinculado_razon" rows="3" placeholder="Explique las razones..."></textarea>
                    </div>
                    
                    <label for="informe_pedagogico">¿Se recibe informe pedagógico cualitativo o certificado que describa el proceso de desarrollo y aprendizaje del estudiante y/o PIAR?</label>
                    <select id="informe_pedagogico" name="informe_pedagogico" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    
                    <div id="modalidad_proveniente_container" style="display:none;">
                        <label for="modalidad_proveniente">¿De qué institución o modalidad proviene el informe?</label>
                        <input type="text" id="modalidad_proveniente" name="modalidad_proveniente" placeholder="Nombre de la institución o modalidad">
                    </div>
                    
                    <label for="asiste_programas_complementarios">¿Está asistiendo en la actualidad a programas complementarios?</label>
                    <select id="asiste_programas_complementarios" name="asiste_programas_complementarios" required>
                        <option value="">Seleccione...</option>
                        <option value="Si">Sí</option>
                        <option value="No">No</option>
                    </select>
                    
                    <label for="observacion">Observaciones (incluir motivos del cambio de modalidad o institución educativa):</label>
                    <textarea id="observacion" name="observacion" rows="4" placeholder="Escriba sus observaciones aquí..."></textarea>
                    
                    <div class="navigation-buttons">
                        <button type="button" class="btn-nav btn-anterior" id="btn-anterior-entorno">Anterior</button>
                        <button type="submit" class="btn-nav btn-registrar">Registrar Estudiante</button>
                    </div>
                </div>
            </form>
        </section>
    </main>

    <footer class="pie-pagina">
        <p>&copy; 2025 Ludik. Todos los derechos reservados.</p>
    </footer>

    <script>
// Registrar_estudiante.js
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('registro-multi-paso');
    let pasoActual = 1;
    const totalPasos = 5; // Actualizado a 5 pasos
    
    // Función para actualizar indicadores de progreso
    function actualizarIndicadores() {
        for (let i = 1; i <= totalPasos; i++) {
            const indicator = document.getElementById(`indicator-${i}`);
            if (indicator) {
                indicator.classList.remove('active', 'completed');
                
                if (i < pasoActual) {
                    indicator.classList.add('completed');
                } else if (i === pasoActual) {
                    indicator.classList.add('active');
                }
            }
        }
    }
    
    // Función para mostrar un paso específico
    function mostrarPaso(numeroPaso) {
        // Ocultar todos los pasos
        document.querySelectorAll('.form-step').forEach(paso => {
            paso.style.display = 'none';
            // IMPORTANTE: Remover required de campos ocultos
            paso.querySelectorAll('input, select, textarea').forEach(campo => {
                campo.removeAttribute('required');
            });
        });
        
        // Mostrar el paso actual
        const pasoVisible = document.getElementById(getPasoId(numeroPaso));
        if (pasoVisible) {
            pasoVisible.style.display = 'block';
            // IMPORTANTE: Agregar required solo a campos visibles
            pasoVisible.querySelectorAll('input, select, textarea').forEach(campo => {
                const esRequerido = debeSerRequerido(campo);
                if (esRequerido) {
                    campo.setAttribute('required', 'required');
                }
            });
        }
        
        pasoActual = numeroPaso;
        actualizarIndicadores();
    }
    
    // Función para determinar el ID del paso
    function getPasoId(numero) {
        const pasos = ['paso-madre', 'paso-padre', 'paso-cuidador', 'paso-estudiante', 'paso-entorno-educativo'];
        return pasos[numero - 1];
    }
    
    // Función para determinar si un campo debe ser requerido
    function debeSerRequerido(campo) {
        // Campos que no deben ser required por defecto
        const camposOpcionales = [
            'victima_tipo', 
            'etnico_tipo',
            'vinculado_detalles',
            'no_vinculado_razon',
            'modalidad_proveniente',
            'observacion'
        ];
        
        if (camposOpcionales.includes(campo.name)) {
            return false;
        }
        
        // Todos los demás campos son requeridos
        return true;
    }
    
    // Función para validar el paso actual
    function validarPasoActual() {
        const pasoVisible = document.getElementById(getPasoId(pasoActual));
        const camposRequeridos = pasoVisible.querySelectorAll('[required]');
        let esValido = true;
        let primerCampoInvalido = null;
        
        camposRequeridos.forEach(campo => {
            if (!campo.value.trim()) {
                if (!primerCampoInvalido) {
                    primerCampoInvalido = campo;
                }
                esValido = false;
            }
        });
        
        if (!esValido && primerCampoInvalido) {
            primerCampoInvalido.focus();
            alert('Por favor, complete todos los campos requeridos.');
        }
        
        return esValido;
    }
    
    // Event listeners para botones "Siguiente"
    document.getElementById('btn-siguiente-madre').addEventListener('click', function(e) {
        e.preventDefault();
        if (validarPasoActual()) {
            mostrarPaso(2);
        }
    });
    
    document.getElementById('btn-siguiente-padre').addEventListener('click', function(e) {
        e.preventDefault();
        if (validarPasoActual()) {
            mostrarPaso(3);
        }
    });
    
    document.getElementById('btn-siguiente-cuidador').addEventListener('click', function(e) {
        e.preventDefault();
        if (validarPasoActual()) {
            mostrarPaso(4);
        }
    });
    
    document.getElementById('btn-siguiente-estudiante').addEventListener('click', function(e) {
        e.preventDefault();
        if (validarPasoActual()) {
            mostrarPaso(5);
        }
    });
    
    // Event listeners para botones "Anterior"
    document.getElementById('btn-anterior-padre').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarPaso(1);
    });
    
    document.getElementById('btn-anterior-cuidador').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarPaso(2);
    });
    
    document.getElementById('btn-anterior-estudiante').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarPaso(3);
    });
    
    document.getElementById('btn-anterior-entorno').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarPaso(4);
    });
    
    // Event listener para botón "Ir a Inicio"
    const btnInicio = document.getElementById('btn-inicio');
    if (btnInicio) {
        btnInicio.addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('¿Está seguro que desea ir al inicio? Se perderán los datos no guardados.')) {
                window.location.href = 'interfaz.html';
            }
        });
    }
    
    // Manejar campos condicionales - Estudiante
    document.getElementById('victima_conflicto').addEventListener('change', function() {
        const container = document.getElementById('victima_tipo_container');
        const campoTipo = document.getElementById('victima_tipo');
        
        if (this.value === 'Si') {
            container.style.display = 'block';
            campoTipo.setAttribute('required', 'required');
        } else {
            container.style.display = 'none';
            campoTipo.removeAttribute('required');
            campoTipo.value = '';
        }
    });
    
    document.getElementById('grupo_etnico').addEventListener('change', function() {
        const container = document.getElementById('etnico_tipo_container');
        const campoTipo = document.getElementById('etnico_tipo');
        
        if (this.value === 'Si') {
            container.style.display = 'block';
            campoTipo.setAttribute('required', 'required');
        } else {
            container.style.display = 'none';
            campoTipo.removeAttribute('required');
            campoTipo.value = '';
        }
    });
    
    // Manejar campos condicionales - Entorno Educativo
    document.getElementById('vinculado_otra_inst').addEventListener('change', function() {
        const detallesContainer = document.getElementById('vinculado_detalles_container');
        const razonContainer = document.getElementById('no_vinculado_razon_container');
        const campoDetalles = document.getElementById('vinculado_detalles');
        const campoRazon = document.getElementById('no_vinculado_razon');
        
        if (this.value === 'Si') {
            detallesContainer.style.display = 'block';
            razonContainer.style.display = 'none';
            campoDetalles.setAttribute('required', 'required');
            campoRazon.removeAttribute('required');
            campoRazon.value = '';
        } else if (this.value === 'No') {
            detallesContainer.style.display = 'none';
            razonContainer.style.display = 'block';
            campoRazon.setAttribute('required', 'required');
            campoDetalles.removeAttribute('required');
            campoDetalles.value = '';
        } else {
            detallesContainer.style.display = 'none';
            razonContainer.style.display = 'none';
            campoDetalles.removeAttribute('required');
            campoRazon.removeAttribute('required');
            campoDetalles.value = '';
            campoRazon.value = '';
        }
    });
    
    document.getElementById('informe_pedagogico').addEventListener('change', function() {
        const container = document.getElementById('modalidad_proveniente_container');
        const campo = document.getElementById('modalidad_proveniente');
        
        if (this.value === 'Si') {
            container.style.display = 'block';
            campo.setAttribute('required', 'required');
        } else {
            container.style.display = 'none';
            campo.removeAttribute('required');
            campo.value = '';
        }
    });
    
    // Validación antes del envío del formulario
    form.addEventListener('submit', function(e) {
        // Asegurarse de que solo los campos visibles tengan required
        document.querySelectorAll('.form-step').forEach(paso => {
            if (paso.style.display === 'none') {
                paso.querySelectorAll('input, select, textarea').forEach(campo => {
                    campo.removeAttribute('required');
                });
            }
        });
        
        // Validar el último paso
        if (!validarPasoActual()) {
            e.preventDefault();
            return false;
        }
        
        // Validación adicional completa del formulario
        if (!validateForm()) {
            e.preventDefault();
            return false;
        }
        
        // El formulario se enviará normalmente si llega aquí
        console.log('Enviando formulario...');
    });
    
    // Función de validación completa del formulario
    function validateForm() {
        const estudianteNombre = document.getElementById('estudiante_nombre').value;
        const madreNombre = document.getElementById('madre_nombre').value;
        const padreNombre = document.getElementById('padre_nombre').value;
        const cuidadorNombre = document.getElementById('cuidador_nombre').value;
        const estado = document.getElementById('estado').value;

        if (!estudianteNombre || !madreNombre || !padreNombre || !cuidadorNombre || !estado) {
            alert('Por favor, complete todos los campos requeridos en todos los pasos.');
            return false;
        }
        return true;
    }
    
    // Inicializar mostrando el primer paso
    mostrarPaso(1);
});

// Función adicional para debugging
function mostrarCamposRequeridos() {
    console.log('Campos requeridos actualmente:');
    document.querySelectorAll('[required]').forEach(campo => {
        console.log(`- ${campo.name}: ${campo.value}`);
    });
}
    </script>
</body>

</html>